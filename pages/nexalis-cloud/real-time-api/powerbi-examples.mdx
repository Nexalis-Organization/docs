---
title: "Power BI Examples"
---

Connect Power BI to Nexalis Cloud's real-time API to query the tags list and create interactive dashboards. This guide shows the recommended approach using Power BI's Web connector with parameters.

---

## Setup: Get ready to query Nexalis API

This method retrieves all available data points from your Nexalis Cloud instance, including labels and attributes like siteName, deviceID, dataObject, multiplier, etc.

### Step 1: Create a Blank Report

1. Open Power BI Desktop
2. Click **Home** → **Get Data** → **Blank Query**

### Step 2: Create Parameters

1. Go to **Home** → **Manage Parameters** → **New Parameter**
2. Create the following parameters:

**Parameter 1: NexalisApiBaseUrl**
- Name: `NexalisApiBaseUrl`
- Type: Text
- Current Value: `https://yourcompany.app.nexalis.io/api/v0`

**Parameter 2: NexalisApiReadToken**
- Name: `NexalisApiReadToken`
- Type: Text
- Current Value: `YOUR_READ_TOKEN`

### Step 3: Create the Tags List Query

1. Create a new blank query
2. Go to **Home** → **Advanced Editor**
3. Paste the following M code:

```m
() as table =>
let
    Url      = NexalisApiBaseUrl & "/find",
    Token    = NexalisApiReadToken,

    ShowAttr = true,
    SortMeta = true,

    Raw = Web.Contents(
        Url,
        [
            Headers = [
                #"X-Warp10-Token" = Token
            ],
            Query = [
                selector = "nx.value{.app=nexalis}",
                showattr = if ShowAttr then "true" else "false",
                sortmeta = if SortMeta then "true" else "false"
            ]
        ]
    ),

    // /find returns TEXT lines: class{labels}{attrs}
    Txt   = Text.FromBinary(Raw),
    Lines = List.Select(
        Lines.FromText(Txt),
        each Text.Trim(_) <> "" and not Text.StartsWith(Text.Trim(_), "#")
    ),
    T0 = Table.FromList(Lines, Splitter.SplitByNothing(), {"line"}, null, ExtraValues.Error),

    // helper: extract the Nth {...} segment
    GetSeg = (s as text, n as number) as nullable text =>
        let
            parts = Text.Split(s, "{"),
            seg   = if List.Count(parts) > n then Text.BeforeDelimiter(parts{n}, "}") else null
        in
            seg,

    // labels are the 1st {...} and attrs are the 2nd {...}
    T1 = Table.AddColumn(T0, "labelsText", each GetSeg([line], 1), type text),
    T2 = Table.AddColumn(T1, "attrsText",  each GetSeg([line], 2), type text),

    // URL decode helper (turns %3D into =, %2F into /, etc.)
    UrlDecode = (s as nullable text) as nullable text =>
        if s = null then null
        else try Uri.Parts("http://x/?" & "p=" & s)[Query][p] otherwise s,

    // Convert "k=v,k2=v2" => record [k=v, k2=v2] (with URL decoding)
    ToRecord = (kv as nullable text) as record =>
        let
            txt   = if kv = null or Text.Trim(kv) = "" then "" else kv,
            pairs = if txt = "" then {} else Text.Split(txt, ","),
            kvs   = List.Transform(pairs, each Text.Split(_, "=")),
            good  = List.Select(kvs, each List.Count(_) = 2),

            keys  = List.Transform(good, each UrlDecode(_{0})),
            vals  = List.Transform(good, each UrlDecode(_{1})),

            rec   = if List.Count(good) = 0 then [] else Record.FromList(vals, keys)
        in
            rec,

    T3 = Table.AddColumn(T2, "labels_rec", each ToRecord([labelsText]), type record),
    T4 = Table.AddColumn(T3, "attrs_rec",  each ToRecord([attrsText]),  type record),

    // Pull required label fields (safe if missing)
    T5 = Table.AddColumn(T4, "dataPoint",    each try Record.Field([labels_rec], "dataPoint")    otherwise null, type text),
    T6 = Table.AddColumn(T5, "deviceID",     each try Record.Field([labels_rec], "deviceID")     otherwise null, type text),
    T7 = Table.AddColumn(T6, "deviceModel",  each try Record.Field([labels_rec], "deviceModel")  otherwise null, type text),
    T8 = Table.AddColumn(T7, "siteName",     each try Record.Field([labels_rec], "siteName")     otherwise null, type text),

    // Pull required attribute fields (safe if missing)
    T9  = Table.AddColumn(T8,  "dataObject",      each try Record.Field([attrs_rec], "dataObject")      otherwise null, type text),
    T10 = Table.AddColumn(T9,  "subDataObject",   each try Record.Field([attrs_rec], "subDataObject")   otherwise null, type text),
    T11 = Table.AddColumn(T10, "protocol",        each try Record.Field([attrs_rec], "protocol")        otherwise null, type text),
    T12 = Table.AddColumn(T11, "multiplier",      each try Record.Field([attrs_rec], "multiplier")      otherwise null, type text),
    T13 = Table.AddColumn(T12, "logicalNode",     each try Record.Field([attrs_rec], "logicalNode")     otherwise null, type text),
    T14 = Table.AddColumn(T13, "measurementType", each try Record.Field([attrs_rec], "measurementType") otherwise null, type text),
    T15 = Table.AddColumn(T14, "description",     each try Record.Field([attrs_rec], "description")     otherwise null, type text),
    T16 = Table.AddColumn(T15, "engUnits",        each try Record.Field([attrs_rec], "engUnits")        otherwise null, type text),
    T17 = Table.AddColumn(T16, "adder",           each try Record.Field([attrs_rec], "adder")           otherwise null, type text),
    T18 = Table.AddColumn(T17, "nx-agent-id",     each try Record.Field([attrs_rec], "nx-agent-id")     otherwise null, type text),
    T19 = Table.AddColumn(T18, "assetType",       each try Record.Field([attrs_rec], "assetType")       otherwise null, type text),
    T20 = Table.AddColumn(T19, "subDeviceID",     each try Record.Field([attrs_rec], "subDeviceID")     otherwise null, type text),

    Result = Table.SelectColumns(
        T20,
        {
            "dataPoint","deviceID","deviceModel","siteName",
            "dataObject","subDataObject","protocol","multiplier","logicalNode",
            "measurementType","description","engUnits","adder","nx-agent-id",
            "assetType","subDeviceID"
        }
    )
in
    Result
```

4. Click **Done**
5. You can rename this function "fnNexalisTagsList"

### Step 5: Create the connection

1. Click **Invoke**, which will prompt the warning message "Please specify how to connect".
2. Click **Edit Credentials**
3. In the "Anonymous" connection method, scroll through the urls list to select "https://yourcompany.app.nexalis.io/api/v0/find"
4. Then click **Connect**

A table with all your tags should now appear in Power BI.

### Step 4: Load the Data

Click **Close & Apply** to load the tags list table into Power BI.

---

## What You Get

Your NexalisTagsList table contains all available tags with their properties:

| Column | Description |
|--------|-------------|
| `siteName` | Site identifier |
| `deviceModel` | Device model name |
| `deviceID` | Unique device identifier |
| `dataPoint` | Raw data point identifier |
| `description` | Human-readable description |
| `assetType` | Asset type (INV, METER, etc.) |
| `dataObject` | Standardized data object name |
| `subDataObject` | Sub-object for complex measurements |
| `logicalNode` | IEC 61850 logical node |
| `measurementType` | Analog or Discrete |
| `engUnits` | Engineering units (kW, kWh, V, etc.) |
| `multiplier` | Scaling multiplier for unit conversion |
| `adder` | Scaling offset for unit conversion |
| `protocol` | Communication protocol used |
| `subDeviceID` | Sub-device identifier if applicable |
| `nx-agent-id` | Nexalis agent version |


---

## Benefits of This Approach

1. **Start with Tags List First**: It's more efficient to query and explore the list of available tags (*FIND*) before fetching tags with their values (*FETCH*). *FIND* queries are lightweight and fast, while *FETCH* returns actual time-series values which can take significantly longer if you're fetching a large time window.

2. **Parameter-Based Configuration**: Parametrizing the URL and token allows you to:
   - **Reuse across functions**: Reference the same parameters in multiple queries without duplicating configuration
   - **Share safely**: Share Power BI functions with colleagues without exposing your personal READ token
---


## Advanced: Fetching Time-Series Data

To fetch actual time-series values, go back to your report, open a new query, and paste the following in the query editor:

```m
let
    Url = NexalisApiBaseUrl & "/exec",
    Token = NexalisApiReadToken,
    
    WarpScript = "{
  'token' '" & Token & "'
  'class' 'nx.value'
  'labels' { 'assetType' 'INV' 'dataObject' 'TotW' }
  'start' '2026-01-15T00:00:00Z'
  'end' '2026-01-15T01:00:00Z'
} FETCH
@nexalis/scale",
    
    Raw = Web.Contents(
        Url,
        [
            Headers = [
                #"X-Warp10-Token" = Token,
                #"Content-Type" = "text/plain; charset=UTF-8"
            ],
            Content = Text.ToBinary(WarpScript)
        ]
    ),
    
    // Parse JSON and transform to table
    // (transformation steps omitted for brevity)
in
    Raw
```

---

## Troubleshooting

### "Unable to connect" Error

- Verify `NexalisApiBaseUrl` is correct (no trailing slash)
- Check that `NexalisApiReadToken` is valid
- Ensure firewall allows HTTPS connections to Nexalis

### Empty Results

- Verify the selector matches your data: `nx.value{.app=nexalis}`
- Check that you have data in your Nexalis Cloud instance
- Contact [contact@nexalis.io](mailto:contact@nexalis.io) for support

### Authentication Failed

- Ensure READ token hasn't expired
- Check for extra spaces in the token parameter
- Request a new token if needed

---

## Next Steps

- Learn about [Nexalis Macros](./nexalis-macros) for data queries
- Integrate with [Python](./python-examples) for data pipelines
- Review the [Real-Time API](./real-time-api) documentation
            'DeviceID': labels.get('deviceID'),
            'DataPoint': labels.get('dataPoint')
        })

df = pd.DataFrame(records)
```

3. Power BI will automatically detect the `df` DataFrame
4. Click **OK** to load the data

---

## Aggregated Data Query

Query pre-aggregated data for better performance:

```m
let
    // Query with hourly aggregation
    WarpScript = "'site_A' 'INV_8896' 'TOTW' 7 d @nexalis/fetch [ SWAP bucketizer.mean 0 1 h 0 ] BUCKETIZE",
    
    Source = Web.Contents(
        "https://yourcompany.app.nexalis.io/api/v0/exec",
        [
            Headers = [
                #"X-Warp10-Token" = "YOUR_READ_TOKEN",
                #"Content-Type" = "text/plain; charset=UTF-8"
            ],
            Content = Text.ToBinary(WarpScript)
        ]
    ),
    
    // Transform as before...
```

---

## Multi-Site Dashboard

Create a multi-site comparison dashboard:

### Power Query for Multiple Sites

```m
let
    Sites = {"site_A", "site_B", "site_C"},
    
    GetSiteData = (siteName as text) =>
        let
            WarpScript = "'" & siteName & "' 'INV_*' 'TOTW' 24 h @nexalis/fetch",
            Source = Web.Contents(
                "https://yourcompany.app.nexalis.io/api/v0/exec",
                [
                    Headers = [
                        #"X-Warp10-Token" = "YOUR_READ_TOKEN",
                        #"Content-Type" = "text/plain; charset=UTF-8"
                    ],
                    Content = Text.ToBinary(WarpScript)
                ]
            ),
            JsonResponse = Json.Document(Source)
            // Transform...
        in
            JsonResponse,
    
    // Fetch data for all sites
    AllSites = List.Transform(Sites, each GetSiteData(_)),
    Combined = Table.Combine(AllSites)
in
    Combined
```

---

## Refresh Configuration

### Automatic Refresh

1. Go to **File** → **Options and settings** → **Data source settings**
2. Select your Warp10 API connection
3. Configure authentication (use API Key method with your token)

### Schedule Refresh (Power BI Service)

1. Publish your report to Power BI Service
2. Go to the dataset settings
3. Configure scheduled refresh (up to 8 times per day on Pro, 48 times on Premium)

**Note:** For real-time streaming, consider using Power BI's streaming datasets with a custom connector or Azure Functions.

---

## Best Practices

### Performance Optimization

1. **Use aggregated queries:** Request hourly or daily aggregations instead of raw second-level data
2. **Limit time ranges:** Fetch only the data you need (e.g., last 7 days instead of all historical data)
3. **Enable query folding:** Use native Power BI transformations when possible
4. **Cache intermediate results:** Store processed data in staging tables

### Security

1. **Don't hardcode tokens:** Use Power BI parameters or Azure Key Vault
2. **Use row-level security:** Restrict data access by site or region
3. **Enable HTTPS only:** Ensure all API calls use secure connections

### Example: Using Parameters for Token

```m
let
    ReadToken = Parameter_ReadToken,  // Reference parameter instead of hardcoded token
    
    Source = Web.Contents(
        "https://yourcompany.app.nexalis.io/api/v0/exec",
        [
            Headers = [
                #"X-Warp10-Token" = ReadToken,
                #"Content-Type" = "text/plain; charset=UTF-8"
            ],
            Content = Text.ToBinary("'site_A' 'INV_8896' 'TOTW' 24 h @nexalis/fetch")
        ]
    )
in
    Source
```

---

## Troubleshooting

### Common Issues

**Error: "Unable to connect"**
- Verify the API endpoint URL is correct
- Check that your token is active
- Ensure firewall allows outbound HTTPS connections

**Error: "Expression.Error: Invalid JSON"**
- The WarpScript query may have syntax errors
- Test the query directly using cURL before using in Power BI

**Slow refresh times**
- Reduce the time range in your queries
- Use aggregated data instead of raw data
- Consider incremental refresh for large datasets

### Testing Queries

Before adding to Power BI, test queries using cURL:

```bash
curl -X POST 'https://yourcompany.app.nexalis.io/api/v0/exec' \
  -H 'X-Warp10-Token: YOUR_READ_TOKEN' \
  -H 'Content-Type: text/plain; charset=UTF-8' \
  -d "'site_A' 'INV_8896' 'TOTW' 24 h @nexalis/fetch"
```

---

## Example Dashboard

Create a complete solar monitoring dashboard:

1. **Power Generation Line Chart:** Show real-time power output
2. **Site Comparison Bar Chart:** Compare total energy across sites
3. **KPI Cards:** Display current power, today's energy, uptime %
4. **Heatmap:** Visualize performance by hour and day
5. **Filters:** Add slicers for site, date range, and device type

---

## Next Steps

- Review [Warp10 macro examples](./warp10-macros) for more query patterns
- Learn about [Python integration](./python-examples) for data pipelines
- Check the [complete API reference](../real-time-api) for advanced features
